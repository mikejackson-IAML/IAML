<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Certificate in Employee Relations Law - IAML. Master employee relations strategies with practicing attorneys. 4½-day intensive program. Learn employment law that prevents 90% of workplace legal issues.">
  <meta name="keywords" content="employee relations law, employment law training, HR certification, IAML certificate program, workplace law">
  <meta name="author" content="Institute for Applied Management & Law">

  <!-- Open Graph / Social Media -->
  <meta property="og:title" content="Certificate in Employee Relations Law - IAML">
  <meta property="og:description" content="Master employee relations strategies with practicing attorneys. Real cases, practical solutions, immediate results.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://iaml.com/programs/employee-relations-law">
  <meta property="og:image" content="https://iaml.com/images/og-image.jpg">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

  <title>Certificate in Employee Relations Law - IAML</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Lato:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Splide CSS (for testimonials carousel) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">

  <!-- Main CSS -->
  <link rel="stylesheet" href="../css/main.css">

  <!-- Google Analytics (Replace with your GA4 ID) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>
</head>
<body>

  <!-- ===== HEADER ===== -->
  <!-- Header Component -->
<header class="header" id="header">
    <!-- Logo -->
    <a href="/" class="header-logo">
        <img src="https://storage.googleapis.com/msgsndr/MjGEy0pobNT9su2YJqFI/media/69042ba0346960d8775fb4a4.svg" alt="IAML Logo">
    </a>

    <!-- Right side: Nav + Button -->
    <div class="header-right">
        <!-- Desktop Navigation -->
        <nav>
            <ul class="header-nav">
                <li><a href="https://iaml.com/featured-programs">Featured Programs</a></li>
                <li><a href="https://iaml.com/corporate-training">Corporate Training</a></li>
                <li><a href="https://iaml.com/about-us">Why IAML</a></li>
            </ul>
        </nav>

        <!-- Desktop CTA Button -->
        <a href="#" class="header-cta" onclick="connectPopup_open(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>
            </svg>
            CONNECT WITH US
        </a>
    </div>

    <!-- Mobile Hamburger -->
    <button class="hamburger" id="hamburger" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
</header>

<!-- Mobile Menu -->
<div class="mobile-backdrop" id="mobileBackdrop"></div>
<nav class="mobile-menu" id="mobileMenu">
    <a href="https://iaml.com/featured-programs">Featured Programs</a>
    <a href="https://iaml.com/corporate-training">Corporate Training</a>
    <a href="https://iaml.com/about-us">Why IAML</a>
    <a href="#" class="header-cta" onclick="connectPopup_open(); closeMobileMenu(); return false;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>
        </svg>
        CONNECT WITH US
    </a>
</nav>

  <!-- ===== MAIN CONTENT ===== -->
  <main>

    <!-- Hero Section - Two Column Layout -->
    <section class="hero-section hero-section-program">
      <div class="container">
        <div class="hero-program-wrapper">
          <!-- Left Column: Program Header -->
          <section class="program-header">
            <h1 class="program-title">
              Certificate in Employee<br>Relations Law
            </h1>

            <p class="program-description">
              Stop guessing about employment law. In 4½ days, you'll master the employee relations strategies that prevent 90% of workplace legal issues. Real cases, practical solutions, immediate results.
            </p>

            <button id="openModalBtn-relations-law" class="register-button" onclick="connectPopup_open()" type="button">
              Program Enrollment Fee: $2,375
            </button>
          </section>

          <!-- Right Column: Next Program Card -->
          <section class="next-program-card">
            <div class="program-card-container" id="nextProgramCard">
              <div style="padding: 20px; text-align: center; color: #666;">Loading next program...</div>
            </div>
          </section>
        </div>
      </div>
    </section>

    <!-- Final CTA Section -->
    <section id="iaml-cta" class="theme-light py-5xl">
      <div class="container container-lg mx-auto text-center">
        <div class="mx-auto">
          <h2 class="font-body text-display-lg text-primary font-light tracking-tight">
            Experience the
            <span class="cta-cascade font-display text-hero text-brand">Professional's Choice in Training</span>
          </h2>

          <p class="font-body text-large text-secondary my-lg">
            Real-world expertise. Guaranteed results. Trusted since 1979.
          </p>

          <div class="cta-button-group">
            <button class="btn btn-primary hover-lift" onclick="connectPopup_open()">
              LET'S TALK
            </button>
            <a href="#all-programs" class="btn btn-register hover-lift">
              REGISTER NOW
            </a>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="footer" role="contentinfo">
    <div class="wrap">
        <nav class="grid" aria-label="Footer">
            <!-- Brand -->
            <section class="brand" aria-label="Organization">
                <div class="logo">
                    <img src="https://storage.googleapis.com/msgsndr/MjGEy0pobNT9su2YJqFI/media/69042ba0346960d8775fb4a4.svg" alt="IAML logo">
                </div>
            </section>

            <!-- Programs -->
            <section class="col">
                <h3>Programs</h3>
                <ul class="list" aria-label="Programs">
                    <li><a href="https://iaml.com/programs/employee-relations-law">Certificate in Employee Relations Law</a></li>
                    <li><a href="https://iaml.com/programs/strategic-hr-leadership">Advanced Certificate in Strategic Employment Law</a></li>
                    <li><a href="https://iaml.com/programs/workplace-investigations">Certificate in Workplace Investigations</a></li>
                    <li><a href="https://iaml.com/programs/strategic-hr-management">Certificate in Strategic HR Management</a></li>
                    <li><a href="https://iaml.com/programs/employee-benefits-law">Certificate in Employee Benefits Law</a></li>
                    <li><a href="https://iaml.com/programs/employee-benefits-law-advanced">Advanced Certificate in Employee Benefits Law</a></li>
                </ul>
            </section>

            <!-- Resources -->
            <section class="col">
                <h3>Resources</h3>
                <ul class="list" aria-label="Resources">
                    <li><a href="https://iaml.com/why-iaml">Why IAML</a></li>
                    <li><a href="https://iaml.com/faculty">Faculty</a></li>
                    <li><a href="https://iaml.com/alumni-benefits">Alumni Benefits</a></li>
                    <li><a href="https://iaml.com/corporate-training">Corporate Training</a></li>
                    <li><a href="https://iaml.com//program-schedule">Schedule &amp; Locations</a></li>
                </ul>
            </section>

            <!-- Support -->
            <section class="col">
                <h3>Support</h3>
                <ul class="list" aria-label="Support">
                    <li><a href="https://iaml.com/faq">FAQ</a></li>
                    <li><a href="https://iaml.com/contact-us">Contact</a></li>
                </ul>
            </section>
        </nav>

        <div class="bottom">
            <div>© 2025 Institute for Applied Management &amp; Law, Inc. All rights reserved.</div>
        </div>
    </div>
  </footer>

  <!-- ===== MODALS ===== -->

  <!-- Connect Modal -->
  <div class="connectPopup-overlay" id="connectPopup_Modal" onclick="connectPopup_closeOnOverlay(event)">
    <div class="connectPopup-modal" onclick="event.stopPropagation();">
      <div class="connectPopup-header">
        <h3>Connect with Us in 20 Seconds or Less</h3>
        <button class="connectPopup-closeBtn" onclick="connectPopup_close()" aria-label="Close">&times;</button>
      </div>
      <div class="connectPopup-body" id="connectPopup_Content">
        <!-- Dynamic content -->
      </div>
    </div>
  </div>

  <!-- ===== JAVASCRIPT ===== -->

  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>

  <!-- Environment Configuration (must load first) -->
  <script src="../js/env-config.js"></script>

  <!-- Your JavaScript Files -->
  <script src="../js/modals.js"></script>
  <script src="../js/main.js"></script>

  <!-- Next Program Card Component -->
  <script>
    // Next Program Card Component JavaScript

    // Configuration
    const NEXT_PROGRAM_CONFIG = {
      baseId: 'applWPVmMkgMWoZIC',
      tableId: 'tblFaya3JyTzyAdjJ',
      viewId: 'viwGwK0DuZyjMzsZI',
      apiKey: 'pat07EXbOrhdAPRO5.84330ef1cb8c7cc21f476e777cff12eb57bbc441e2db1a7a0c2817525e588b24'
    };

    // Timezone-neutral date parsing to avoid date shifting issues
    function parseTimezoneNeutralDate(dateString) {
      if (!dateString) return null;

      // Parse date as YYYY-MM-DD and create date in local timezone at noon
      // This prevents timezone shifts from changing the date
      const [year, month, day] = dateString.split('-').map(Number);
      const date = new Date(year, month - 1, day, 12, 0, 0, 0);

      // Set to midnight for comparison purposes
      date.setHours(0, 0, 0, 0);
      return date;
    }

    // Fetch next program from Airtable
    async function fetchNextProgram() {
      try {
        const url = `https://api.airtable.com/v0/${NEXT_PROGRAM_CONFIG.baseId}/${NEXT_PROGRAM_CONFIG.tableId}?view=${NEXT_PROGRAM_CONFIG.viewId}`;

        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${NEXT_PROGRAM_CONFIG.apiKey}`,
            'Content-Type': 'application/json'
          }
        });

        if (!response.ok) {
          console.error('API Response Error:', response.status, response.statusText);
          throw new Error(`Failed to fetch data: ${response.status}`);
        }

        const data = await response.json();
        console.log('Fetched data:', data); // Debug log

        const nextProgram = findNextProgram(data.records);

        if (nextProgram) {
          console.log('Found next program:', nextProgram); // Debug log
          generateNextProgramCard(nextProgram);
        } else {
          console.log('No upcoming programs found'); // Debug log
          // Simply hide the card if no programs
          document.getElementById('nextProgramCard').style.display = 'none';
        }

      } catch (error) {
        console.error('Error fetching next program:', error);
        // Simply hide the card on error
        document.getElementById('nextProgramCard').style.display = 'none';
      }
    }

    // Find the next upcoming Certificate in Employee Relations Law program
    function findNextProgram(records) {
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      const upcomingPrograms = records
        .filter(record => {
          const fields = record.fields;

          // Filter for Certificate in Employee Relations Law
          if (!fields.Program || !fields.Program.includes('Certificate in Employee Relations Law')) {
            return false;
          }

          // Must have required fields
          if (!fields['Session Start Date'] || !fields.City || !fields.State || !fields['Hero Image Attachment']) {
            return false;
          }

          // Check if Hero Image Attachment has valid URL
          if (!fields['Hero Image Attachment'] || !fields['Hero Image Attachment'][0] || !fields['Hero Image Attachment'][0].url) {
            return false;
          }

          // Remove programs that have started (on start date)
          const startDate = parseTimezoneNeutralDate(fields['Session Start Date']);
          return startDate > today;
        })
        .sort((a, b) => {
          // Sort by start date (soonest first)
          const dateA = parseTimezoneNeutralDate(a.fields['Session Start Date']);
          const dateB = parseTimezoneNeutralDate(b.fields['Session Start Date']);
          return dateA - dateB;
        });

      return upcomingPrograms.length > 0 ? upcomingPrograms[0] : null;
    }

    // Generate the next program card
    function generateNextProgramCard(program) {
      const cardContainer = document.getElementById('nextProgramCard');
      const fields = program.fields;

      const startDate = parseTimezoneNeutralDate(fields['Session Start Date']);
      const endDate = parseTimezoneNeutralDate(fields['Session End Date']);
      const dateRange = formatDateRange(startDate, endDate);

      // Safely extract image URL from attachment field
      const imageUrl = fields['Hero Image Attachment'] && fields['Hero Image Attachment'][0]
        ? fields['Hero Image Attachment'][0].url
        : '';

      cardContainer.innerHTML = `
        <div class="hero-program-card">
          <div class="card-image-container">
            <img src="${imageUrl}" alt="${fields.City}" class="hero-background-image" loading="lazy">
            <div class="card-overlay">
              <div class="next-program-badge">Next Program</div>

              <div class="program-info">
                <div class="program-location">${fields.City}, ${fields.State}</div>
                <div class="program-dates">${dateRange}</div>
              </div>

              <div class="program-link-container">
                <a href="#all-programs" class="view-all-programs-link">
                  View All Upcoming Programs
                </a>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Format date range for display
    function formatDateRange(startDate, endDate) {
      if (startDate.getMonth() === endDate.getMonth() && startDate.getFullYear() === endDate.getFullYear()) {
        // Same month: "October 6-10, 2025"
        return `${startDate.toLocaleDateString('en-US', { month: 'long' })} ${startDate.getDate()}-${endDate.getDate()}, ${startDate.getFullYear()}`;
      } else {
        // Different months: "March 30 - April 3, 2025"
        const startMonth = startDate.toLocaleDateString('en-US', { month: 'long' });
        const startDay = startDate.getDate();
        const endMonth = endDate.toLocaleDateString('en-US', { month: 'long' });
        const endDay = endDate.getDate();
        const year = endDate.getFullYear();

        if (startDate.getFullYear() === endDate.getFullYear()) {
          return `${startMonth} ${startDay} - ${endMonth} ${endDay}, ${year}`;
        } else {
          return `${startMonth} ${startDay}, ${startDate.getFullYear()} - ${endMonth} ${endDay}, ${year}`;
        }
      }
    }

    // Initialize component when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      fetchNextProgram();
    });

    // Optional: Refresh data every 5 minutes
    setInterval(fetchNextProgram, 5 * 60 * 1000);
  </script>

  <!-- Header Scroll Behavior -->
  <script>
    // ============================================================================
    // OPTIMIZED HEADER SCROLL BEHAVIOR
    // ============================================================================
    //
    // State Machine:
    // 1. AT_TOP (0-50px): Visible, transparent background
    // 2. SCROLLING_UP (>50px, moving up): Visible, glass effect
    // 3. SCROLLING_DOWN (>70px, moving down): Hidden
    //
    // Key Improvements:
    // - INSTANT response to scroll-up (no threshold)
    // - Asymmetric thresholds for better UX
    // - Debounced scroll direction detection
    // - Handles rapid direction changes
    // - Accounts for bounce scrolling
    // ============================================================================

    const header = document.getElementById('header');

    // Scroll state tracking
    let lastScrollTop = 0;
    let scrollDirection = 'none'; // 'up', 'down', 'none'
    let ticking = false;

    // Thresholds
    const GLASS_EFFECT_THRESHOLD = 50;  // When to apply glass morphism
    const HIDE_THRESHOLD = 70;           // When to hide header on scroll-down
    const SCROLL_DELTA_MIN = 1;          // Minimum scroll delta to register (handles jitter)

    // Direction change detection (prevents bounce scroll issues)
    let scrollDeltaAccumulator = 0;
    const DIRECTION_CHANGE_THRESHOLD = 5; // Pixels needed to confirm direction change

    /**
     * Main header update function - handles all state transitions
     * @param {number} scrollTop - Current scroll position
     */
    function updateHeaderState(scrollTop) {
      const scrollDelta = scrollTop - lastScrollTop;

      // Direction detection with accumulation (prevents jitter)
      if (Math.abs(scrollDelta) >= SCROLL_DELTA_MIN) {
        scrollDeltaAccumulator += scrollDelta;
        lastScrollTop = scrollTop;
      }

      const isDeltaSignificant = Math.abs(scrollDeltaAccumulator) >= DIRECTION_CHANGE_THRESHOLD;
      const isMovingUp = scrollDeltaAccumulator < 0;
      const isMovingDown = scrollDeltaAccumulator > 0;

      // State: AT_TOP (0-50px) - transparent, no glass effect
      if (scrollTop < GLASS_EFFECT_THRESHOLD) {
        header.classList.remove('scrolled', 'hidden');
        scrollDeltaAccumulator = 0;
      }
      // State: Moving up at any scroll position
      else if (isDeltaSignificant && isMovingUp) {
        header.classList.remove('hidden');
        header.classList.add('scrolled');
        scrollDeltaAccumulator = 0;
      }
      // State: Moving down and past HIDE_THRESHOLD
      else if (isDeltaSignificant && isMovingDown && scrollTop > HIDE_THRESHOLD) {
        header.classList.add('hidden');
        scrollDeltaAccumulator = 0;
      }
    }

    // Debounced scroll handler
    function onScroll() {
      const scrollTop = window.scrollY || document.documentElement.scrollTop;

      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateHeaderState(scrollTop);
          ticking = false;
        });
        ticking = true;
      }
    }

    // Event listener
    window.addEventListener('scroll', onScroll, { passive: true });
  </script>

</body>
</html>
