<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IAML - Centered CTA (Light) - Two Buttons</title>

  <!-- Design System CSS (light version extends base) -->
  <link rel="stylesheet" href="design-system.css">
  <link rel="stylesheet" href="design-system-light.css">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Lato:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* Minimal CTA button styling adapted from component (with fallbacks) */
    .cta-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 16px 32px;
      background: var(--primary-blue, #188BF6);
      color: var(--pure-white, #ffffff);
      border: none;
      border-radius: 12px;
      font-family: 'Lato', sans-serif;
      font-size: 16px;
      font-weight: 600;
      text-decoration: none;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(24, 139, 246, 0.3);
    }

    .cta-button:hover {
      background: var(--primary-blue-hover, #1478d1);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(24, 139, 246, 0.4);
    }

    .cta-button:active { transform: translateY(0); }
    .cta-button:focus { outline: none; }
    .cta-button:focus-visible {
      outline: 2px solid var(--primary-blue, #188BF6);
      outline-offset: 4px;
    }

    /* Red button variant for Register Now */
    .cta-button.cta-red {
      background: #DC2626;
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
    }

    .cta-button.cta-red:hover {
      background: #B91C1C;
      box-shadow: 0 8px 20px rgba(220, 38, 38, 0.4);
    }

    .cta-button.cta-red:focus-visible {
      outline: 2px solid #DC2626;
      outline-offset: 4px;
    }

    /* Button container for two-button layout */
    .cta-button-group {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    /* Responsive: stack buttons on small screens */
    @media (max-width: 500px) {
      .cta-button-group {
        flex-direction: column;
        width: 100%;
      }
      .cta-button {
        width: 100%;
        max-width: 300px;
      }
    }

    /* Headline cascade treatment */
    .cta-cascade { display:block; line-height:1.05; }
    @media (max-width:768px){ .cta-cascade { font-size: clamp(2rem, 8vw, 3rem); } }

    /* Stabilize spacing/typography in production */
    h2{ margin:0 0 .5rem 0; }
    .cta-cascade{ margin:.1em 0 .15em 0; }
    .my-lg{ margin-top:1rem; margin-bottom:1.5rem; }

    /* Host-page resilient headline sizing & colors for light */
    #iaml-cta { font-size: 16px; }
    #iaml-cta h2{ font-family: 'Lato', sans-serif !important; font-size: clamp(20.4px, 2.64vw, 36.8px); line-height: 1.1; letter-spacing: -0.02em; }
    #iaml-cta .cta-cascade{ font-size: clamp(34.4px, 4.31vw, 59.7px); line-height: 1.05; margin:.1em 0 .15em 0; font-weight: 500; font-family: 'Playfair Display', serif; font-style: italic; letter-spacing: -0.01em; }
    #iaml-cta h2{ color: var(--light-text-primary, #1f2937); }
    #iaml-cta .text-brand{ color: var(--primary-blue, #188bf6) !important; }

    /* ===== Connect Modal Styles (portable) ===== */
    #connectPopup_waitText2 { margin-bottom: 30px; }
    .all-set{background: transparent !important;border: none !important;}
    .connectPopup-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);z-index:1000;opacity:0;transition:opacity .3s ease;pointer-events:none}
    .connectPopup-overlay.active{display:flex;align-items:center;justify-content:center;opacity:1;pointer-events:auto}
    .connectPopup-modal{background:#fff;border-radius:16px;box-shadow:0 24px 48px rgba(0,0,0,.2),0 8px 16px rgba(0,0,0,.1);max-width:560px;width:92%;max-height:90vh;overflow-y:auto;transform:scale(.9) translateY(20px);transition:transform .3s cubic-bezier(.4,0,.2,1)}
    .connectPopup-overlay.active .connectPopup-modal{transform:scale(1) translateY(0)}
    .connectPopup-header{display:flex;justify-content:space-between;align-items:center;padding:40px;border-bottom:1px solid #e5e7eb;background:linear-gradient(135deg,#28528c 0%,#222639 100%);color:#fff;}
    .connectPopup-header h3{font-family:'Lato',sans-serif;font-size:1.3rem;font-weight:700;margin:0}
    .connectPopup-closeBtn{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#fff;padding:4px;border-radius:4px;transition:all .2s ease;line-height:1}
    .connectPopup-closeBtn:hover{background:rgba(255,255,255,.1)}
    .connectPopup-body{padding:40px}
    .connectPopup-body p{font-family:'Lato',sans-serif;font-size:1rem;color:#4b5563;margin-bottom:18px;line-height:1.6}
    .connectPopup-form{display:flex;flex-direction:column;gap:16px}
    .connectPopup-group{display:flex;flex-direction:column}
    .connectPopup-group label{font-family:'Lato',sans-serif;font-size:.875rem;font-weight:600;color:#374151;margin-bottom:6px}
    .connectPopup-group input, .connectPopup-group textarea{font-family:'Lato',sans-serif;font-size:1rem;padding:12px 16px;border:1px solid #d1d5db;border-radius:8px;background:#fff;color:#1f2937;transition:all .2s ease}
    .connectPopup-group input::placeholder, .connectPopup-group textarea::placeholder{color:#9ca3af}
    .connectPopup-group input:focus, .connectPopup-group textarea:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,.1)}
    .connectPopup-submitBtn{padding:14px 28px;border-radius:12px;font-family:'Lato',sans-serif;font-size:1rem;font-weight:700;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);text-transform:uppercase;letter-spacing:.5px;border:none;width:100%;background:linear-gradient(135deg,rgba(59,130,246,.9) 0%,rgba(37,99,235,.95) 100%);color:#fff;box-shadow:0 8px 24px rgba(59,130,246,.25),0 2px 6px rgba(0,0,0,.1)}
    .connectPopup-submitBtn:hover:not(:disabled){transform:translateY(-2px);background:linear-gradient(135deg,rgba(59,130,246,1) 0%,rgba(37,99,235,1) 100%);box-shadow:0 12px 32px rgba(59,130,246,.35),0 4px 12px rgba(0,0,0,.15)}
    .connectPopup-submitBtn:disabled{opacity:.6;cursor:not-allowed}
    .connectPopup-thinking{display:flex;align-items:center;gap:14px;background:#f8fafc;border:1px solid #e5e7eb;border-radius:12px;padding:18px 16px}
    .phone-pulse{width:38px;height:38px;border-radius:10px;place-items:center;background:#28528c;position:relative;overflow:visible;display:none!important;}
    .phone-pulse::after,.phone-pulse::before{content:"";position:absolute;inset:-6px;border-radius:12px;border:2px solid rgba(40,82,140,.35);animation:pulse 1.8s ease-out infinite}
    .phone-pulse::before{animation-delay:.9s}
    @keyframes pulse{0%{transform:scale(.7);opacity:1}100%{transform:scale(1.5);opacity:0}}
    .phone-pulse svg{width:20px;height:20px;fill:#fff}
    .dots{display:inline-flex;gap:6px;align-items:flex-end}
    .dots i{width:6px;height:6px;border-radius:50%;background:#28528c;opacity:.35;animation:blink 1.1s infinite}
    .dots i:nth-child(2){animation-delay:.15s}
    .dots i:nth-child(3){animation-delay:.3s}
    @keyframes blink{0%,80%,100%{opacity:.25;transform:translateY(0)}40%{opacity:1;transform:translateY(-4px)}}
    .muted{color:#6b7280;font-size:.95rem}
    .small-gap{margin-top:8px}
    @media (max-width:600px){ .connectPopup-modal{margin:20px;width:calc(100% - 40px)} .connectPopup-header,.connectPopup-body{padding:20px} }
    
    /* Host-page resilient colors (light) */
    #iaml-cta h2.text-primary { color: #1f2937 !important; }
    #iaml-cta .text-secondary { color: #475569 !important; }
    #iaml-cta .text-brand { color: var(--primary-blue, #188bf6) !important; }

    /* Custom extra-large padding for CTA section */
    #iaml-cta.py-5xl {
      padding-top: 15rem;    /* 240px */
      padding-bottom: 15rem; /* 240px */
    }
  </style>
</head>
<body>

  <!-- Centered CTA - LIGHT BACKGROUND - TWO BUTTONS -->
  <section id="iaml-cta" class="theme-light py-5xl">
    <div class="container container-lg mx-auto text-center">
      <div class="mx-auto">
        <!-- Headline with highlighted phrase (centered) -->
        <h2 class="font-body text-display-lg text-primary font-light tracking-tight">
          Experience the 
          <span class="cta-cascade font-display text-hero text-brand">Professional's Choice in Training</span>
        </h2>

        <!-- Subheadline -->
        <p class="font-body text-large text-secondary my-lg">Real-world expertise. Guaranteed results. Trusted since 1979.</p>

        <!-- CTA Buttons - Two Button Layout -->
        <div class="cta-button-group">
          <button class="cta-button hover-lift" id="openContactModal" aria-label="Open contact form" onclick="connectPopup_open()">
            Let's Talk
          </button>
          <a id="registerNowBtn-relations-law" class="cta-button cta-red hover-lift relations-law-trigger" aria-label="Register now" data-modal-target="employee-relations-law" onclick="if(window.IAMLRelationsLawModal && window.IAMLRelationsLawModal.openModal) { window.IAMLRelationsLawModal.openModal(); } else { console.error('Modal function not available'); }">
            Register Now
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Connect Modal (portable include) -->
  <div class="connectPopup-overlay" id="connectPopup_Modal" onclick="connectPopup_closeOnOverlay(event)">
    <div class="connectPopup-modal" onclick="event.stopPropagation();">
      <div class="connectPopup-header">
        <h3>Connect with Us in 20 Seconds or Less</h3>
        <button class="connectPopup-closeBtn" onclick="connectPopup_close()" aria-label="Close">&times;</button>
      </div>
      <div class="connectPopup-body" id="connectPopup_Content"><!-- dynamic --></div>
    </div>
  </div>

  <script>
    /* ===== Connect Modal Config (replace with your webhook) ===== */
    const GHL_WEBHOOK = 'https://your-webhook.example.com/replace-me';
    const CONNECT_TIMEOUT_MS = 20000;

    /* ===== State ===== */
    let connectTimeoutHandle = null;
    let lastSubmission = { firstName: '', phone: '' };

    /* ===== Open / Close ===== */
    function connectPopup_open(){
      const modal = document.getElementById('connectPopup_Modal');
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
      renderStep('form');
    }
    function connectPopup_close(){
      const modal = document.getElementById('connectPopup_Modal');
      modal.classList.remove('active');
      document.body.style.overflow = 'auto';
      clearTimeout(connectTimeoutHandle);
    }
    function connectPopup_closeOnOverlay(e){ if (e.target === e.currentTarget) connectPopup_close(); }
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') connectPopup_close(); });

    /* ===== Step Renderer ===== */
    function renderStep(step, payload = {}){
      const root = document.getElementById('connectPopup_Content');

      if(step === 'form'){
        root.innerHTML = `
          <p>Give us your name and phone number - we'll connect you with one of our program coordinators who can answer your questions and get you exactly what you need.</p>
          <form class="connectPopup-form" id="connectPopup_Form">
            <div class="connectPopup-group">
              <label for="connectPopup_firstName">First Name *</label>
              <input type="text" id="connectPopup_firstName" name="firstName" required />
            </div>
            <div class="connectPopup-group">
              <label for="connectPopup_phone">Phone Number *</label>
              <input type="tel" id="connectPopup_phone" name="phone" required />
            </div>
            <button type="submit" class="connectPopup-submitBtn">Connect</button>
          </form>
        `;
        document.getElementById('connectPopup_Form').addEventListener('submit', connectPopup_submit);
      }

      if(step === 'connecting'){
        root.innerHTML = `
          <div class="connectPopup-thinking" role="status" aria-live="polite">
            <div class="phone-pulse" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>
            </div>
            <div class="muted">
              <strong>Connecting you with one of our program coordinators...</strong>
              <div class="small-gap muted">We're matching you with the specialist who can best answer your questions about our programs, services, or any other support you need. <span class="dots" aria-hidden="true"><i></i><i></i><i></i></span></div>
            </div>
          </div>
          <p class="muted">If a coordinator picks up, we'll connect you right away. Please keep this window open.</p>
        `;
      }

      if(step === 'email-fallback'){
        root.innerHTML = `
          <div class="muted" id="connectPopup_waitText1"><strong>We're still trying to connect you...</strong></div>
          <div class="muted small-gap" id="connectPopup_waitText2" style="opacity:0;">Our coordinators are currently helping other professionals with their program decisions, but we don't want to delay your registration process. Let's get your questions answered via email instead.</div>
          <form class="connectPopup-form" id="connectPopup_EmailForm">
            <div class="connectPopup-group">
              <label for="connectPopup_email">Email *</label>
              <input type="email" id="connectPopup_email" name="email" placeholder="you@company.com" required />
            </div>
            <div class="connectPopup-group">
              <label for="connectPopup_question">Question *</label>
              <textarea rows="3" id="connectPopup_question" name="question" placeholder="submit your question" required></textarea>
            </div>
            <button type="submit" class="connectPopup-submitBtn">GET ANSWERS NOW</button>
          </form>
        `;
        requestAnimationFrame(()=> setTimeout(()=> {
          const el = document.getElementById('connectPopup_waitText2');
          if(el) el.style.opacity = 1;
        }, 1300));
        document.getElementById('connectPopup_EmailForm').addEventListener('submit', connectPopup_submitEmailFallback);
      }

      if(step === 'success'){
        root.innerHTML = `
          <p><strong>Thanks ${escapeHtml(payload.firstName || '')}!</strong> We've received your details and a coordinator will reach out shortly.</p>
          <div class="connectPopup-thinking all-set" style="margin-top:10px">
            <div class="phone-pulse" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>
            </div>
          </div>
        `;
      }

      if(step === 'error'){
        root.innerHTML = `
          <p><strong>Hmm, something went wrong.</strong></p>
          <p class="muted">${payload.message || 'Please try again, or send your details by email below.'}</p>
          <button class="connectPopup-submitBtn" onclick="renderStep('form')">Try Again</button>
        `;
      }
    }

    /* ===== Submit: Connect attempt ===== */
    async function connectPopup_submit(e){
      e.preventDefault();
      const formData = new FormData(e.target);
      const firstName = (formData.get('firstName') || '').toString().trim();
      const phone = (formData.get('phone') || '').toString().trim();
      lastSubmission = { firstName, phone };

      renderStep('connecting');

      clearTimeout(connectTimeoutHandle);
      connectTimeoutHandle = setTimeout(()=> renderStep('email-fallback'), CONNECT_TIMEOUT_MS);

      try{
        const res = await fetch(GHL_WEBHOOK, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ firstName, phone, tags:'contact_button_initiated', source:'Website Contact Form', contactType:'lead' })
        });

        if(!res.ok){
          const result = await safeJson(res);
          throw new Error(result?.message || `Request failed (${res.status})`);
        }

        if (typeof gtag !== 'undefined') {
          gtag('event','form_submit',{event_category:'Contact',event_label:'Connect Modal Success'});
        }
      }catch(err){
        console.error('Webhook error:', err);
        if (typeof gtag !== 'undefined') {
          gtag('event','form_error',{event_category:'Contact',event_label:'Connect Modal Error',error_message:String(err?.message||err)});
        }
        clearTimeout(connectTimeoutHandle);
        renderStep('email-fallback');
      }
    }

    /* ===== Submit: Email fallback ===== */
    async function connectPopup_submitEmailFallback(e){
      e.preventDefault();
      const fd = new FormData(e.target);
      const email = (fd.get('email')||'').toString().trim();

      const btn = e.target.querySelector('.connectPopup-submitBtn');
      btn.disabled = true; btn.textContent = 'Sending...';

      try{
        const res = await fetch(GHL_WEBHOOK, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ firstName: lastSubmission.firstName, phone: lastSubmission.phone, email, tags:'contact_button_email_fallback', source:'Website Contact Form', contactType:'lead' })
        });
        if(!res.ok){
          const result = await safeJson(res);
          throw new Error(result?.message || `Request failed (${res.status})`);
        }
        renderStep('success', { firstName: lastSubmission.firstName });
      }catch(err){
        console.error('Fallback error:', err);
        renderStep('error', { message: "We couldn't send your email just now. Please try again." });
      }
    }

    /* ===== Helpers ===== */
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }
    async function safeJson(res){ try{ return await res.json(); }catch{ return null; } }

    /* ===== CTA button wiring ===== */
    document.addEventListener('DOMContentLoaded', function(){
      const openContactBtn = document.getElementById('openContactModal');
      if (openContactBtn) {
        openContactBtn.addEventListener('click', function(){
          if (typeof connectPopup_open === 'function') {
            connectPopup_open();
          } else {
            const event = new CustomEvent('openContactModal');
            document.dispatchEvent(event);
          }
        });
      }
    });
  </script>

</body>
</html>

