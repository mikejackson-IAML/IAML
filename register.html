<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register | IAML</title>
  <meta name="description" content="Register for IAML certificate programs in employment law, HR management, and workplace investigations.">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/1-variables.css">
  <link rel="stylesheet" href="css/2-base.css">
  <link rel="stylesheet" href="css/3-components.css">
  <link rel="stylesheet" href="css/4-layout.css">
  <link rel="stylesheet" href="css/5-pages.css">

  <!-- Environment Configuration -->
  <script src="/js/env-config.local.js"></script>
  <script>
    // Fallback if local config doesn't exist
    if (typeof ENV_CONFIG === 'undefined') {
      window.ENV_CONFIG = {};
    }
  </script>

  <!-- Stripe -->
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body class="register-page">
  <!-- Skip Link for Accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- Simple Header -->
  <header class="register-header">
    <a href="/" class="register-logo">
      <img src="https://storage.googleapis.com/msgsndr/NCSFmxJpj6zN0k8f6yDE/media/681f7f8e65f1c05be55f4c9d.png" alt="IAML - Institute for Applied Management & Law" height="50">
    </a>
    <a href="/" class="register-back-link">‚Üê Back to Home</a>
  </header>

  <main id="main-content" class="register-main">
    <div class="register-container">
      <!-- Left Column: Form -->
      <div class="register-form-column">
        <!-- Progress Stepper -->
        <nav class="register-stepper" aria-label="Registration progress">
          <ol class="stepper-list" id="stepperList">
            <!-- Steps will be dynamically generated based on URL params -->
          </ol>
        </nav>

        <!-- Step Cards -->
        <div class="register-steps">
          <!-- Step: Format Selection -->
          <section id="step-format" class="register-step" data-step="format" aria-labelledby="step-format-title">
            <h2 id="step-format-title" class="step-title">Select Your Program Format</h2>
            <p class="step-subtitle">Choose how you'd like to attend your program</p>
            <div class="format-options">
              <label class="format-option">
                <input type="radio" name="format" value="in-person">
                <div class="format-card">
                  <div class="format-icon">üèõÔ∏è</div>
                  <div class="format-info">
                    <strong>In-Person</strong>
                    <span>Attend live at a venue near you</span>
                  </div>
                </div>
              </label>
              <label class="format-option">
                <input type="radio" name="format" value="virtual">
                <div class="format-card">
                  <div class="format-icon">üíª</div>
                  <div class="format-info">
                    <strong>Virtual</strong>
                    <span>Join live online via Zoom</span>
                  </div>
                </div>
              </label>
              <label class="format-option">
                <input type="radio" name="format" value="on-demand">
                <div class="format-card">
                  <div class="format-icon">‚ñ∂Ô∏è</div>
                  <div class="format-info">
                    <strong>On-Demand</strong>
                    <span>Learn at your own pace</span>
                  </div>
                </div>
              </label>
            </div>
          </section>

          <!-- Step: Program Selection -->
          <section id="step-program" class="register-step hidden" data-step="program" aria-labelledby="step-program-title">
            <h2 id="step-program-title" class="step-title">Select Your Program</h2>
            <p class="step-subtitle">Choose the certificate program you'd like to enroll in</p>
            <div class="program-options" id="programOptions">
              <!-- Programs populated by JS -->
            </div>
          </section>

          <!-- Step: Block Selection (only for applicable programs) -->
          <section id="step-blocks" class="register-step hidden" data-step="blocks" aria-labelledby="step-blocks-title">
            <h2 id="step-blocks-title" class="step-title">Select Your Attendance</h2>
            <p class="step-subtitle">Choose to attend the full program or select specific blocks</p>
            <div class="block-options" id="blockOptions">
              <!-- Blocks populated by JS -->
            </div>
          </section>

          <!-- Step: Session Selection -->
          <section id="step-session" class="register-step hidden" data-step="session" aria-labelledby="step-session-title">
            <h2 id="step-session-title" class="step-title">Select Your Session</h2>
            <p class="step-subtitle">Choose a date and location that works for you</p>
            <div class="session-list" id="sessionList">
              <!-- Sessions populated by JS -->
            </div>
            <div id="sessionsLoading" class="sessions-loading hidden">
              <div class="spinner"></div>
              <span>Loading available sessions...</span>
            </div>
            <div id="sessionsEmpty" class="sessions-empty hidden">
              No sessions currently available for this selection.
            </div>
          </section>

          <!-- Step: Contact Information -->
          <section id="step-contact" class="register-step hidden" data-step="contact" aria-labelledby="step-contact-title">
            <h2 id="step-contact-title" class="step-title">Your Information</h2>
            <p class="step-subtitle">Tell us about yourself</p>
            <form id="contactForm" class="contact-form" novalidate>
              <div class="form-row">
                <div class="form-field">
                  <label for="firstName">First Name <span class="required">*</span></label>
                  <input type="text" id="firstName" name="firstName" autocomplete="given-name" required>
                  <span class="field-error" id="firstNameError"></span>
                </div>
                <div class="form-field">
                  <label for="lastName">Last Name <span class="required">*</span></label>
                  <input type="text" id="lastName" name="lastName" autocomplete="family-name" required>
                  <span class="field-error" id="lastNameError"></span>
                </div>
              </div>
              <div class="form-row">
                <div class="form-field">
                  <label for="contactTitle">Title <span class="optional">(optional)</span></label>
                  <input type="text" id="contactTitle" name="title" autocomplete="organization-title" placeholder="Your job title">
                </div>
                <div class="form-field">
                  <label for="company">Company <span class="optional">(optional)</span></label>
                  <input type="text" id="company" name="company" autocomplete="organization" placeholder="Company name">
                </div>
              </div>
              <div class="form-row">
                <div class="form-field">
                  <label for="phone">Phone <span class="required">*</span></label>
                  <input type="tel" id="phone" name="phone" autocomplete="tel" required placeholder="(555) 555-5555">
                  <span class="field-error" id="phoneError"></span>
                </div>
                <div class="form-field">
                  <label for="email">Email <span class="required">*</span></label>
                  <input type="email" id="email" name="email" autocomplete="email" required placeholder="your.email@example.com">
                  <span class="field-error" id="emailError"></span>
                </div>
              </div>
              <div class="form-field coupon-field">
                <label for="couponCode">Coupon Code <span class="optional">(optional)</span></label>
                <div class="coupon-input-row">
                  <input type="text" id="couponCode" name="couponCode" placeholder="Enter code">
                  <button type="button" id="applyCouponBtn" class="btn-coupon">Apply</button>
                </div>
                <span class="coupon-message" id="couponMessage" aria-live="polite"></span>
              </div>
            </form>
          </section>

          <!-- Step: Payment Method Selection -->
          <section id="step-payment" class="register-step hidden" data-step="payment" aria-labelledby="step-payment-title">
            <h2 id="step-payment-title" class="step-title">Payment Method</h2>
            <p class="step-subtitle">Choose how you'd like to pay</p>

            <div class="payment-options">
              <label class="payment-option">
                <input type="radio" name="paymentMethod" value="invoice">
                <div class="payment-card">
                  <div class="payment-icon">üìÑ</div>
                  <div class="payment-info">
                    <strong>Bill My Employer</strong>
                    <span>We'll send an invoice to your company's billing department</span>
                  </div>
                </div>
              </label>
              <label class="payment-option">
                <input type="radio" name="paymentMethod" value="stripe">
                <div class="payment-card">
                  <div class="payment-icon">üí≥</div>
                  <div class="payment-info">
                    <strong>Pay Now with Card</strong>
                    <span>Complete your registration today via secure payment</span>
                  </div>
                </div>
              </label>
            </div>

            <!-- Bill Employer Form -->
            <div id="billingForm" class="billing-form hidden">
              <h3 class="billing-title">Billing Information</h3>
              <div class="form-row">
                <div class="form-field">
                  <label for="billingContactName">Billing Contact Name <span class="required">*</span></label>
                  <input type="text" id="billingContactName" name="billingContactName" required>
                  <span class="field-error" id="billingContactNameError"></span>
                </div>
                <div class="form-field">
                  <label for="billingContactEmail">Billing Contact Email <span class="required">*</span></label>
                  <input type="email" id="billingContactEmail" name="billingContactEmail" required>
                  <span class="field-error" id="billingContactEmailError"></span>
                </div>
              </div>
              <div class="form-field">
                <label for="billingAddress">Billing Address <span class="required">*</span></label>
                <input type="text" id="billingAddress" name="billingAddress" autocomplete="street-address" required>
                <span class="field-error" id="billingAddressError"></span>
              </div>
              <div class="form-row form-row-3">
                <div class="form-field">
                  <label for="billingCity">City <span class="required">*</span></label>
                  <input type="text" id="billingCity" name="billingCity" autocomplete="address-level2" required>
                  <span class="field-error" id="billingCityError"></span>
                </div>
                <div class="form-field">
                  <label for="billingState">State <span class="required">*</span></label>
                  <input type="text" id="billingState" name="billingState" autocomplete="address-level1" required>
                  <span class="field-error" id="billingStateError"></span>
                </div>
                <div class="form-field">
                  <label for="billingZip">ZIP Code <span class="required">*</span></label>
                  <input type="text" id="billingZip" name="billingZip" autocomplete="postal-code" required>
                  <span class="field-error" id="billingZipError"></span>
                </div>
              </div>
              <div class="form-row">
                <div class="form-field">
                  <label for="billingPO">PO Number <span class="optional">(optional)</span></label>
                  <input type="text" id="billingPO" name="billingPO" placeholder="If required by your company">
                </div>
                <div class="form-field">
                  <label for="billingNotes">Special Instructions <span class="optional">(optional)</span></label>
                  <input type="text" id="billingNotes" name="billingNotes" placeholder="Any special billing instructions">
                </div>
              </div>
            </div>

            <!-- Stripe Payment Form -->
            <div id="stripeForm" class="stripe-form hidden">
              <h3 class="stripe-title">Card Details</h3>
              <div id="card-element" class="stripe-card-element">
                <!-- Stripe Elements will be inserted here -->
              </div>
              <div id="card-errors" class="stripe-errors" role="alert"></div>
            </div>
          </section>

          <!-- Confirmation: Invoice -->
          <section id="step-confirm-invoice" class="register-step hidden" data-step="confirm-invoice" aria-labelledby="confirm-invoice-title">
            <div class="confirmation-content">
              <div class="confirmation-icon-success">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                </svg>
              </div>
              <h2 id="confirm-invoice-title" class="confirmation-title">You're Registered!</h2>
              <p class="confirmation-subtitle">Your spot in the <span id="confInvoiceProgram">program</span> is almost confirmed. See below for next steps.</p>

              <div class="confirmation-summary-box">
                <div class="confirmation-summary-header">
                  <h3>Registration Summary</h3>
                  <span id="confInvoiceFormatBadge" class="format-badge">IN-PERSON</span>
                </div>
                <div class="confirmation-details">
                  <div class="detail-row"><span class="label">Participant:</span><span class="value" id="confInvoiceName">‚Äî</span></div>
                  <div class="detail-row"><span class="label">Email:</span><span class="value" id="confInvoiceEmail">‚Äî</span></div>
                  <div class="detail-row"><span class="label">Program:</span><span class="value" id="confInvoiceProgramName">‚Äî</span></div>
                  <div class="detail-row" id="confInvoiceDatesRow"><span class="label">Dates:</span><span class="value" id="confInvoiceDates">‚Äî</span></div>
                  <div class="detail-row" id="confInvoiceLocationRow"><span class="label">Location:</span><span class="value" id="confInvoiceLocation">‚Äî</span></div>
                  <div class="detail-row"><span class="label">Enrollment Fee:</span><span class="value" id="confInvoicePrice">‚Äî</span></div>
                </div>
              </div>

              <div class="confirmation-next-steps">
                <h3>What Happens Next</h3>
                <div class="next-step urgent">
                  <div class="step-number">1</div>
                  <div class="step-content">
                    <h4>Check Your Email Right Now!</h4>
                    <p><strong>Your invoice is being sent as you read this.</strong></p>
                    <div class="check-email-box">
                      <strong>What to do:</strong><br>
                      1. Check your email inbox (search for "IAML Invoice")<br>
                      2. Can't find it? Check your spam/junk folder<br>
                      3. Click "Pay Now" to complete your registration
                    </div>
                  </div>
                </div>
                <div class="next-step">
                  <div class="step-number">2</div>
                  <div class="step-content">
                    <h4>Get Ready to Succeed</h4>
                    <p>Once your invoice is paid, you'll be able to book your complimentary pre-program consultation.</p>
                  </div>
                </div>
                <div class="next-step">
                  <div class="step-number">3</div>
                  <div class="step-content">
                    <h4>Prepare for Day 1</h4>
                    <p>We'll send pre-program information one week before your program starts.</p>
                  </div>
                </div>
              </div>

              <div class="confirmation-help">
                <p><strong>Questions about your registration?</strong></p>
                <p>Contact us at <a href="mailto:info@iaml.com">info@iaml.com</a> or call <a href="tel:+19497601700">(949) 760-1700</a></p>
              </div>
            </div>
          </section>

          <!-- Confirmation: Paid -->
          <section id="step-confirm-paid" class="register-step hidden" data-step="confirm-paid" aria-labelledby="confirm-paid-title">
            <div class="confirmation-content">
              <div class="confirmation-icon-success">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                </svg>
              </div>
              <h2 id="confirm-paid-title" class="confirmation-title">Payment Successful!</h2>
              <p class="confirmation-subtitle">You're officially enrolled in the <span id="confPaidProgram">program</span>. Welcome to IAML!</p>

              <div class="confirmation-summary-box">
                <div class="confirmation-summary-header">
                  <h3>Registration Summary</h3>
                  <span id="confPaidFormatBadge" class="format-badge">IN-PERSON</span>
                </div>
                <div class="confirmation-details">
                  <div class="detail-row"><span class="label">Participant:</span><span class="value" id="confPaidName">‚Äî</span></div>
                  <div class="detail-row"><span class="label">Email:</span><span class="value" id="confPaidEmail">‚Äî</span></div>
                  <div class="detail-row"><span class="label">Program:</span><span class="value" id="confPaidProgramName">‚Äî</span></div>
                  <div class="detail-row" id="confPaidDatesRow"><span class="label">Dates:</span><span class="value" id="confPaidDates">‚Äî</span></div>
                  <div class="detail-row" id="confPaidLocationRow"><span class="label">Location:</span><span class="value" id="confPaidLocation">‚Äî</span></div>
                  <div class="detail-row"><span class="label">Amount Paid:</span><span class="value" id="confPaidPrice">‚Äî</span></div>
                </div>
              </div>

              <div class="confirmation-next-steps">
                <h3>What Happens Next</h3>
                <div class="next-step">
                  <div class="step-number">1</div>
                  <div class="step-content">
                    <h4>Check Your Email</h4>
                    <p>You'll receive a confirmation email with your receipt and registration details.</p>
                  </div>
                </div>
                <div class="next-step">
                  <div class="step-number">2</div>
                  <div class="step-content">
                    <h4>Book Your Consultation</h4>
                    <p>Schedule your complimentary pre-program consultation to maximize your learning experience.</p>
                  </div>
                </div>
                <div class="next-step">
                  <div class="step-number">3</div>
                  <div class="step-content">
                    <h4>Prepare for Day 1</h4>
                    <p>We'll send pre-program information one week before your program starts.</p>
                  </div>
                </div>
              </div>

              <div class="confirmation-help">
                <p><strong>Questions about your registration?</strong></p>
                <p>Contact us at <a href="mailto:info@iaml.com">info@iaml.com</a> or call <a href="tel:+19497601700">(949) 760-1700</a></p>
              </div>
            </div>
          </section>
        </div>

        <!-- Navigation Buttons -->
        <div class="register-nav" id="registerNav">
          <button type="button" id="backBtn" class="btn btn-secondary hidden">Back</button>
          <div class="nav-spacer"></div>
          <button type="button" id="nextBtn" class="btn btn-primary">Continue</button>
          <button type="button" id="submitBtn" class="btn btn-primary hidden">Complete Registration</button>
        </div>

        <!-- Global Messages -->
        <div id="globalMessage" class="global-message hidden" role="alert" aria-live="polite"></div>
      </div>

      <!-- Right Column: Summary Sidebar -->
      <aside class="register-sidebar" id="registerSidebar">
        <div class="sidebar-sticky">
          <h3 class="sidebar-title">Registration Summary</h3>

          <div class="summary-section" id="summaryProgram">
            <div class="summary-label">Program</div>
            <div class="summary-value" id="summaryProgramValue">‚Äî</div>
          </div>

          <div class="summary-section" id="summaryFormat">
            <div class="summary-label">Format</div>
            <div class="summary-value">
              <span id="summaryFormatBadge" class="format-badge-small">‚Äî</span>
            </div>
          </div>

          <div class="summary-section hidden" id="summaryBlocks">
            <div class="summary-label">Attendance</div>
            <div class="summary-value" id="summaryBlocksValue">Full Program</div>
          </div>

          <div class="summary-section hidden" id="summarySession">
            <div class="summary-label">Session</div>
            <div class="summary-value" id="summarySessionValue">‚Äî</div>
          </div>

          <div class="summary-section hidden" id="summaryLocation">
            <div class="summary-label">Location</div>
            <div class="summary-value" id="summaryLocationValue">‚Äî</div>
          </div>

          <div class="summary-divider"></div>

          <div class="summary-pricing">
            <div class="pricing-row" id="pricingBase">
              <span class="pricing-label" id="pricingBaseLabel">Program Fee</span>
              <span class="pricing-amount" id="pricingBaseAmount">$0</span>
            </div>
            <div class="pricing-row discount hidden" id="pricingDiscount">
              <span class="pricing-label" id="pricingDiscountLabel">Discount</span>
              <span class="pricing-amount" id="pricingDiscountAmount">-$0</span>
            </div>
            <div class="pricing-total">
              <span class="pricing-label">Total Due</span>
              <span class="pricing-amount" id="pricingTotal">$0</span>
            </div>
          </div>

          <div class="summary-help">
            <p>Questions? <a href="mailto:info@iaml.com">info@iaml.com</a></p>
            <p><a href="tel:+19497601700">(949) 760-1700</a></p>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay hidden" aria-hidden="true">
    <div class="loading-box">
      <div class="spinner"></div>
      <span class="loading-message">Processing...</span>
    </div>
  </div>

  <!-- Config -->
  <script src="api/config.js"></script>

  <!-- Registration JS -->
  <script src="js/register.js"></script>
</body>
</html>
