<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Meet IAML's faculty of practicing employment law attorneys and HR professionals. Expert instructors delivering employment law training, HR management courses, and workplace law education since 1979.">
  <meta name="keywords" content="employment law training, labor and employment law, HR management training, employment law CLE, workplace law attorneys, SHRM certification, HR professional development, employment law instructors, benefits law faculty">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://iaml.com/pages/faculty">
  <meta name="author" content="Institute for Applied Management & Law">

  <!-- Open Graph / Social Media -->
  <meta property="og:title" content="Employment Law & HR Training Faculty | Practicing Attorneys Who Teach">
  <meta property="og:description" content="Learn employment law and HR management from practicing attorneys and Fortune 500 HR executives. IAML faculty bring real courtroom and boardroom experience to every training program.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://iaml.com/pages/faculty">
  <meta property="og:image" content="https://iaml.com/images/og-faculty.jpg">
  <meta property="og:site_name" content="IAML - Institute for Applied Management & Law">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Employment Law & HR Training Faculty | IAML">
  <meta name="twitter:description" content="Learn from practicing employment law attorneys and HR executives. Real-world expertise in labor law, workplace investigations, and HR management.">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

  <title>Employment Law & HR Training Faculty | IAML Practicing Attorneys</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Lato:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- CDN & External Service Preconnects -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://storage.googleapis.com">
  <link rel="preconnect" href="https://www.googletagmanager.com">

  <!-- Main CSS -->
  <link rel="stylesheet" href="../css/main.css">

  <!-- Google Analytics (Replace with your GA4 ID) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>

  <!-- Structured Data: Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "EducationalOrganization",
    "name": "IAML - Institute for Applied Management & Law",
    "alternateName": "IAML",
    "url": "https://iaml.com",
    "logo": "https://iaml.com/images/iaml-logo.png",
    "description": "Professional employment law training and HR management education delivered by practicing attorneys and HR executives since 1979.",
    "foundingDate": "1979",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "US"
    },
    "sameAs": [
      "https://www.linkedin.com/company/iaml"
    ],
    "hasCredential": [
      {
        "@type": "EducationalOccupationalCredential",
        "credentialCategory": "Certificate",
        "name": "Certificate in Employment Law"
      },
      {
        "@type": "EducationalOccupationalCredential",
        "credentialCategory": "Certificate",
        "name": "Certificate in HR Management"
      }
    ]
  }
  </script>

  <!-- Structured Data: Faculty Page (CollectionPage) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Employment Law & HR Training Faculty",
    "description": "Meet IAML's faculty of practicing employment law attorneys and HR professionals delivering expert training in labor law, HR management, and workplace compliance.",
    "url": "https://iaml.com/pages/faculty",
    "isPartOf": {
      "@type": "WebSite",
      "name": "IAML",
      "url": "https://iaml.com"
    },
    "about": {
      "@type": "EducationalOrganization",
      "name": "IAML"
    },
    "mainEntity": {
      "@type": "ItemList",
      "name": "IAML Faculty Members",
      "description": "Practicing attorneys and HR professionals who teach employment law and HR management courses",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "item": {
            "@type": "CategoryCode",
            "name": "Employment Law Faculty",
            "description": "Practicing employment law attorneys with decades of experience representing employers in high-stakes cases"
          }
        },
        {
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@type": "CategoryCode",
            "name": "HR Management Faculty",
            "description": "HR executives from Fortune 500 companies who built departments and managed through workplace crises"
          }
        },
        {
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@type": "CategoryCode",
            "name": "Benefits Law Faculty",
            "description": "Benefits attorneys who have defended multi-million dollar benefit plan lawsuits"
          }
        },
        {
          "@type": "ListItem",
          "position": 4,
          "item": {
            "@type": "CategoryCode",
            "name": "Environmental Health & Safety Faculty",
            "description": "Attorneys specializing in OSHA compliance, workplace safety, and incident management"
          }
        }
      ]
    }
  }
  </script>

  <!-- Structured Data: BreadcrumbList -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://iaml.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Faculty",
        "item": "https://iaml.com/pages/faculty"
      }
    ]
  }
  </script>
</head>
<body class="faculty-page">

  <!-- ===== HEADER ===== -->
  <!-- Header placeholder (loaded by components.js) -->
  <div id="header-placeholder"></div>

  <!-- NoScript fallback for progressive enhancement -->
  <noscript>
    <nav style="position: fixed; top: 0; width: 100%; background: white; padding: 16px; text-align: center; z-index: 1000;">
      <a href="/">Home</a> |
      <a href="/featured-programs">Programs</a> |
      <a href="/pages/corporate-training">Corporate</a> |
      <a href="/about-us">Why IAML</a>
    </nav>
  </noscript>

  <!-- ===== MAIN CONTENT ===== -->
  <main>

    <!-- ===== HERO SECTION ===== -->
    <section class="faculty-hero-section">
      <div class="faculty-hero-content">
        <div class="faculty-trusted-text">
          LEARN FROM ATTORNEYS WHO WIN CASES, NOT TRAINERS WHO READ ABOUT THEM
        </div>

        <h1 class="faculty-main-headline">
          Meet the Practicing Attorneys Who<br>
          Teach What Actually Works
        </h1>

        <p class="faculty-hero-description">
          Other companies use corporate trainers with PowerPoint slides. We use practicing attorneys and experienced HR professionals who handle workplace law challenges daily. When they teach, they're sharing what actually worked in real situations, not theories from textbooks.
        </p>

        <div class="faculty-button-container">
          <a href="program-schedule.html" class="btn btn-primary btn-lg">Training Schedule</a>
          <a href="#" class="btn btn-register btn-lg" onclick="connectPopup_open(); return false;">Reserve Your Spot</a>
        </div>
      </div>
    </section>

    <!-- ===== FACULTY CONTENT SECTION ===== -->
    <section class="faculty-content-section">
      <div class="faculty-page-container">

        <!-- Quick Navigation -->
        <nav class="unified-nav faculty-nav" role="navigation" aria-label="Practice areas">
          <div class="unified-nav-container">
            <a href="#employment-law" class="unified-nav-item active">Employment Law</a>
            <a href="#hr-management" class="unified-nav-item">HR Management</a>
            <a href="#benefits-law" class="unified-nav-item">Benefits Law</a>
            <a href="#safety-law" class="unified-nav-item">Environmental Health & Safety</a>
          </div>
        </nav>

        <!-- Faculty Sections -->
        <div class="faculty-content">
          <!-- Employment Law Section -->
          <section id="employment-law" class="practice-section">
            <h2 class="practice-area-title">Employment Law</h2>
            <p class="practice-description">After decades representing employers in high-stakes cases, these attorneys know the difference between what the regulations say and what actually works in practice.</p>

            <div class="faculty-grid">
              <!-- Faculty cards will be populated dynamically from Airtable -->
            </div>
          </section>

          <!-- HR Management Section -->
          <section id="hr-management" class="practice-section">
            <h2 class="practice-area-title">HR Management</h2>
            <p class="practice-description">HR executives who've built departments from the ground up, managed through every crisis you can imagine, and learned what actually works in real workplaces.</p>

            <div class="faculty-grid">
              <!-- Faculty cards will be populated dynamically from Airtable -->
            </div>
          </section>

          <!-- Benefits Law Section -->
          <section id="benefits-law" class="practice-section">
            <h2 class="practice-area-title">Benefits Law</h2>
            <p class="practice-description">Benefits attorneys who've defended multi-million dollar benefit plan lawsuits and know exactly which compliance gaps create the biggest risks - and how to fix them.</p>

            <div class="faculty-grid">
              <!-- Faculty cards will be populated dynamically from Airtable -->
            </div>
          </section>

          <!-- Environmental Health & Safety Section -->
          <section id="safety-law" class="practice-section">
            <h2 class="practice-area-title">Environmental Health & Safety</h2>
            <p class="practice-description">Attorneys who've managed workplace incidents, defended OSHA citations, and learned what prevention strategies actually work in the real world.</p>

            <div class="faculty-grid">
              <!-- Faculty cards will be populated dynamically from Airtable -->
            </div>
          </section>
        </div>

      </div>
    </section>

    <!-- ===== FINAL CTA SECTION ===== -->
    <section id="iaml-cta" class="theme-light py-5xl">
      <div class="container container-lg mx-auto text-center">
        <div class="mx-auto">
          <h2 class="font-body text-display-lg text-primary font-light tracking-tight">
            Experience the
            <span class="cta-cascade font-display text-hero text-brand">Professional's Choice in Training</span>
          </h2>

          <p class="font-body text-large text-secondary my-lg">
            Real-world expertise. Guaranteed results. Trusted since 1979.
          </p>

          <div class="cta-button-group">
            <button class="btn btn-primary hover-lift" id="openContactModal" onclick="connectPopup_open()">
              LET'S TALK
            </button>
            <a href="https://iaml.com/featured-programs" class="btn btn-register hover-lift">
              REGISTER NOW
            </a>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ===== FOOTER ===== -->
  <!-- Footer placeholder (loaded by components.js) -->
  <div id="footer-placeholder"></div>

  <!-- ===== MODALS ===== -->

  <!-- Connect Modal -->
  <div class="connectPopup-overlay" id="connectPopup_Modal" onclick="connectPopup_closeOnOverlay(event)">
    <div class="connectPopup-modal" onclick="event.stopPropagation();">
      <div class="connectPopup-header">
        <h3>Connect with Us in 20 Seconds or Less</h3>
        <button class="connectPopup-closeBtn" onclick="connectPopup_close()" aria-label="Close">&times;</button>
      </div>
      <div class="connectPopup-body" id="connectPopup_Content">
        <!-- Dynamic content -->
      </div>
    </div>
  </div>

  <!-- ===== JAVASCRIPT ===== -->

  <!-- Dynamic Component Loading -->
  <script src="../js/components.js" defer></script>
  <script src="../js/utm-tracking.js" defer></script>
  <script src="../js/headerBehavior.js" defer></script>
  <script src="../js/mobileMenu.js" defer></script>

  <!-- Your JavaScript Files -->
  <script src="../js/modals.js" defer></script>
  <script src="../js/main.js" defer></script>

  <!-- Practice Area Navigation -->
  <script>
    // ============================================================================
    // PRACTICE AREA NAVIGATION
    // ============================================================================
    let navigationFixed = false;

    function forceFixNavigation() {
      if (navigationFixed) return;

      const navLinks = document.querySelectorAll('.unified-nav-item');

      // Remove all existing event listeners by cloning elements
      navLinks.forEach((link, index) => {
        const newLink = link.cloneNode(true);
        link.parentNode.replaceChild(newLink, link);
      });

      // Get fresh references
      const freshNavLinks = document.querySelectorAll('.unified-nav-item');

      // Apply our click handlers
      freshNavLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();

          // Force remove active from ALL links
          freshNavLinks.forEach(l => {
            l.classList.remove('active');
          });

          // Force add active to clicked link
          this.classList.add('active');

          // Handle scrolling
          const targetId = this.getAttribute('href').substring(1);
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      });

      // Set first link as active initially
      if (freshNavLinks.length > 0) {
        freshNavLinks[0].classList.add('active');
      }

      navigationFixed = true;
    }

    // Apply fix multiple times to ensure it overrides everything
    document.addEventListener('DOMContentLoaded', forceFixNavigation);
    window.addEventListener('load', forceFixNavigation);
    setTimeout(forceFixNavigation, 500);
    setTimeout(forceFixNavigation, 1000);
  </script>

  <!-- Faculty Page JavaScript: Airtable Integration -->
  <script>
    // ============================================================================
    // AIRTABLE CONFIGURATION
    // ============================================================================
    const AIRTABLE_CONFIG = {
      facultyTableId: 'tblVz9VPGhZgE4jBD',
      testimonialsTableId: 'tbl6zcJf1KWGICwvy',
      programInstancesTableId: 'tblympiL1p6PmQz9i'
    };

    // Cache configuration
    const CACHE_KEY = 'iaml_faculty_programs';
    const TESTIMONIALS_CACHE_KEY = 'iaml_faculty_testimonials';
    const CACHE_DURATION = 30 * 60 * 1000; // 30 minutes

    // ============================================================================
    // UTILITY FUNCTIONS
    // ============================================================================

    /**
     * Escape HTML to prevent XSS
     */
    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    /**
     * Get instructor headshot URL from Airtable field
     */
    function getInstructorHeadshot(record) {
      // Check for the "Headshot Photo" field (text field with direct URL)
      if (record.fields['Headshot Photo'] && typeof record.fields['Headshot Photo'] === 'string') {
        const url = record.fields['Headshot Photo'].trim();
        if (url.startsWith('http://') || url.startsWith('https://')) {
          return url;
        }
      }

      // Fallback: Check for attachment field
      if (record.fields['Headshot Photo'] && Array.isArray(record.fields['Headshot Photo']) && record.fields['Headshot Photo'].length > 0) {
        return record.fields['Headshot Photo'][0]?.url;
      }

      return null;
    }

    /**
     * Format bio text to preserve paragraphs
     */
    function formatBioText(bioText) {
      if (!bioText) return '';

      const escapedText = escapeHtml(bioText);

      const paragraphs = escapedText
        .split(/\n\s*\n/)
        .map(p => p.trim())
        .filter(p => p.length > 0);

      if (paragraphs.length === 1) {
        const singleLineParagraphs = escapedText
          .split(/\n/)
          .map(p => p.trim())
          .filter(p => p.length > 0);

        if (singleLineParagraphs.length > 1) {
          return singleLineParagraphs
            .map(p => `<p>${p}</p>`)
            .join('');
        }
      }

      return paragraphs
        .map(paragraph => `<p>${paragraph}</p>`)
        .join('');
    }

    /**
     * Format bar admissions text
     */
    function formatBarAdmissions(barAdmissionsText) {
      if (!barAdmissionsText) return '';

      const escapedText = escapeHtml(barAdmissionsText.trim());

      if (escapedText.includes(',')) {
        return `<strong>Bar Admissions:</strong> ${escapedText}`;
      }

      const entries = escapedText
        .split(/\n/)
        .map(entry => entry.trim())
        .filter(entry => entry.length > 0);

      if (entries.length > 1) {
        return `<strong>Bar Admissions:</strong> ${entries.join(', ')}`;
      }

      return `<strong>Bar Admissions:</strong> ${escapedText}`;
    }

    /**
     * Format education text
     */
    function formatEducation(educationText) {
      if (!educationText) return '';

      const escapedText = escapeHtml(educationText.trim());

      const lines = escapedText
        .split(/\n/)
        .map(line => line.trim())
        .filter(line => line.length > 0);

      if (lines.length === 1) {
        return `<strong>Education:</strong> ${lines[0]}`;
      } else if (lines.length >= 2) {
        const firstDegree = lines[0];
        const additionalDegrees = lines.slice(1);

        const indentedDegrees = additionalDegrees
          .map(degree => `<div style="margin-top: 2px;">${degree}</div>`)
          .join('');

        return `<strong>Education:</strong> ${firstDegree}${indentedDegrees}`;
      }

      return `<strong>Education:</strong> ${escapedText}`;
    }

    // ============================================================================
    // FACULTY CARD CREATION
    // ============================================================================

    /**
     * Create a faculty card element
     */
    function createFacultyCard(instructor) {
      const cardDiv = document.createElement('div');
      cardDiv.className = 'faculty-card';
      cardDiv.setAttribute('data-faculty-id', instructor.facultyId);

      const imageUrl = instructor.headshot || '/images/placeholder-attorney.jpg';

      cardDiv.innerHTML = `
        <div class="faculty-image-container">
          <img src="${imageUrl}" alt="${escapeHtml(instructor.name)}" class="faculty-headshot" loading="lazy">
        </div>
        <div class="faculty-info">
          <h3 class="faculty-name">${escapeHtml(instructor.name)}</h3>
          <div class="faculty-credentials">${escapeHtml(instructor.title)}</div>
          <div class="faculty-bio">
            ${formatBioText(instructor.bio)}
          </div>

          <!-- Credentials Section (Education & Bar Admissions) -->
          <div class="credentials-section">
            ${instructor.education ? `<div class="education">${formatEducation(instructor.education)}</div>` : ''}
            ${instructor.barAdmissions ? `<div class="bar-admissions">${formatBarAdmissions(instructor.barAdmissions)}</div>` : ''}
          </div>

          <!-- Teaching Programs Section -->
          <div class="teaching-programs" style="display: none;">
            <div class="programs-list" id="programs-${instructor.facultyId}">
              <div class="loading-skeleton">Loading upcoming programs...</div>
            </div>
          </div>

          <!-- On-Demand Programs Section -->
          <div class="teaching-programs" style="display: none;">
            <div class="programs-list" id="on-demand-${instructor.facultyId}">
              <div class="loading-skeleton">Loading on-demand programs...</div>
            </div>
          </div>

          <!-- Testimonial Section -->
          <div class="testimonial-section" id="testimonials-${instructor.facultyId}" style="display: none;">
            <!-- Testimonials will be populated dynamically -->
          </div>
        </div>
      `;

      return cardDiv;
    }

    // ============================================================================
    // POPULATE FACULTY CARDS
    // ============================================================================

    /**
     * Populate faculty cards dynamically based on instructor data
     */
    function populateFacultyCards(instructorRecords) {
      const practiceAreaMap = {
        'Employment Law': 'employment-law',
        'HR Management': 'hr-management',
        'Benefits Law': 'benefits-law',
        'Environmental Health & Safety': 'safety-law'
      };

      // Clear existing faculty cards
      Object.values(practiceAreaMap).forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (section) {
          const facultyGrid = section.querySelector('.faculty-grid');
          if (facultyGrid) {
            facultyGrid.innerHTML = '';
          }
        }
      });

      // Group instructors by practice areas
      const instructorsByPractice = {};

      instructorRecords.forEach(record => {
        // Full Name (without credentials) for ID generation - keeps IDs consistent
        const fullName = record.fields['Full Name'] || '';
        // Full Name with Credentials for display
        let instructorName = record.fields['Full Name with Credentials'] || fullName;
        let instructorTitle = record.fields['Current Title'] || '';
        const organization = record.fields['Current Firm/Organization'] || '';

        // If name is empty but title contains both, split them
        if (!instructorName && instructorTitle) {
          let separators = [' – ', ' - ', ' — ', ' | ', '  '];
          let foundSeparator = false;

          for (let separator of separators) {
            if (instructorTitle.includes(separator)) {
              const parts = instructorTitle.split(separator);
              instructorName = parts[0].trim();
              instructorTitle = parts[1].trim();
              foundSeparator = true;
              break;
            }
          }

          if (!foundSeparator && instructorTitle.length > 0) {
            instructorName = instructorTitle;
            instructorTitle = '';
          }
        }

        // Combine title and organization: "Job Title, Organization"
        const displayTitle = instructorTitle && organization
          ? `${instructorTitle}, ${organization}`
          : instructorTitle || organization;

        const instructor = {
          id: record.id,
          name: instructorName,
          title: displayTitle,
          lastName: record.fields['Last Name'] || '',
          firstName: record.fields['First Name'] || '',
          practiceAreas: Array.isArray(record.fields['Practice Areas'])
            ? record.fields['Practice Areas']
            : (record.fields['Practice Areas'] ? [record.fields['Practice Areas']] : []),
          bio: record.fields['Full Bio'] || '',
          education: record.fields['Education'] || '',
          barAdmissions: record.fields['Bar Admissions'] || '',
          headshot: getInstructorHeadshot(record),
          facultyId: (fullName || instructorName).toLowerCase()
            .replace(/[^a-z0-9\s]/g, '')
            .replace(/\s+/g, '-')
            .replace(/^-+|-+$/g, '')
        };

        // Add instructor to each of their practice areas
        if (instructor.practiceAreas && instructor.practiceAreas.length > 0) {
          instructor.practiceAreas.forEach(practiceArea => {
            if (!instructorsByPractice[practiceArea]) {
              instructorsByPractice[practiceArea] = [];
            }
            instructorsByPractice[practiceArea].push(instructor);
          });
        } else {
          // Default to Employment Law if no practice areas specified
          if (!instructorsByPractice['Employment Law']) {
            instructorsByPractice['Employment Law'] = [];
          }
          instructorsByPractice['Employment Law'].push(instructor);
        }
      });

      // Create faculty cards for each practice area
      Object.entries(instructorsByPractice).forEach(([practiceArea, instructors]) => {
        const sectionId = practiceAreaMap[practiceArea];
        if (!sectionId) return;

        const section = document.getElementById(sectionId);
        if (!section) return;

        let facultyGrid = section.querySelector('.faculty-grid');
        if (!facultyGrid) {
          facultyGrid = document.createElement('div');
          facultyGrid.className = 'faculty-grid';
          section.appendChild(facultyGrid);
        }

        // Sort instructors alphabetically by last name
        const sortedInstructors = instructors.sort((a, b) => {
          const lastNameA = (a.lastName || '').toLowerCase().trim();
          const lastNameB = (b.lastName || '').toLowerCase().trim();

          if (lastNameA && lastNameB) {
            return lastNameA.localeCompare(lastNameB);
          }

          const getLastName = (fullName) => {
            const nameParts = fullName.toLowerCase().trim().split(/\s+/);
            return nameParts[nameParts.length - 1];
          };

          const fallbackLastNameA = getLastName(a.name);
          const fallbackLastNameB = getLastName(b.name);
          return fallbackLastNameA.localeCompare(fallbackLastNameB);
        });

        // Create cards for each instructor
        sortedInstructors.forEach(instructor => {
          const facultyCard = createFacultyCard(instructor);
          facultyGrid.appendChild(facultyCard);
        });
      });
    }

    // ============================================================================
    // AIRTABLE DATA FETCHING
    // ============================================================================

    /**
     * Fetch records from Airtable via the server-side proxy
     */
    async function fetchAllAirtableRecords(tableId, filterFormula = null) {
      const params = new URLSearchParams();
      params.set('table', tableId);
      if (filterFormula) params.set('filterByFormula', filterFormula);

      const response = await fetch(`/api/airtable-programs?${params.toString()}`);
      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.error || `Proxy error: ${response.status}`);
      }
      const data = await response.json();
      return data.records || [];
    }

    /**
     * Load instructor data from Airtable
     */
    async function loadInstructorData() {
      try {
        const records = await fetchAllAirtableRecords(AIRTABLE_CONFIG.facultyTableId);
        populateFacultyCards(records);

        // Handle deep linking after cards are populated
        handleDeepLink();

      } catch (error) {
        console.error('Error loading instructor data:', error);

        // Show error message in faculty grids
        document.querySelectorAll('.faculty-grid').forEach(grid => {
          grid.innerHTML = '<p class="loading-skeleton">Unable to load faculty data. Please refresh the page.</p>';
        });
      }
    }

    /**
     * Handle deep linking to specific faculty members
     */
    function handleDeepLink() {
      const hash = window.location.hash;
      if (hash && hash.length > 1) {
        const facultyId = hash.substring(1);
        const facultyCard = document.querySelector(`[data-faculty-id="${facultyId}"]`);

        if (facultyCard) {
          // Scroll to the card
          setTimeout(() => {
            facultyCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Add highlight effect
            facultyCard.classList.add('highlighted');

            // Remove highlight after animation
            setTimeout(() => {
              facultyCard.classList.remove('highlighted');
            }, 6000);
          }, 500);
        }
      }
    }

    // ============================================================================
    // UPCOMING PROGRAMS
    // ============================================================================

    // Store faculty name -> facultyId mapping for program matching
    let facultyNameToIdMap = {};

    /**
     * Format date for display (e.g., "Jan 15, 2025")
     */
    function formatProgramDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', {
        month: 'short',
        day: 'numeric',
        year: 'numeric'
      });
    }

    // Program name to page slug mapping
    const PROGRAM_PAGE_SLUGS = {
      'certificate in employer relations law': 'employee-relations-law',
      'certificate in strategic hr leadership': 'strategic-hr-leadership',
      'advanced certificate in strategic employment law': 'strategic-employment-law',
      'certificate in workplace investigations': 'workplace-investigations',
      'certificate in employee benefits law': 'employee-benefits-law',
      'advanced certificate in employee benefits law': 'employee-benefits-law-advanced',
      'employment law update': 'employment-law-update'
    };

    /**
     * Create HTML for a single program card
     */
    function createProgramCardHtml(program) {
      const name = escapeHtml(program.name);
      const startDate = formatProgramDate(program.startDate);
      const endDate = formatProgramDate(program.endDate);
      const dateRange = endDate ? `${startDate} - ${endDate}` : startDate;

      let location = 'Virtual';
      if (program.format && program.format.toLowerCase().includes('in-person')) {
        location = program.city && program.state
          ? `${escapeHtml(program.city)}, ${escapeHtml(program.state)}`
          : program.city || program.state || 'In-Person';
      }

      // Get program page URL from mapping
      const programSlug = PROGRAM_PAGE_SLUGS[program.name.toLowerCase()];
      const learnMoreUrl = programSlug ? `/programs/${programSlug}` : '/program-schedule';

      // Use Registration URL from Airtable, fallback to program schedule
      const registerUrl = program.registrationUrl || '/program-schedule';

      return `
        <div class="program-card">
          <div class="program-card-name">${name}</div>
          <div class="program-card-details">
            <span class="program-card-dates">${dateRange}</span>
            <span class="program-card-location">${location}</span>
          </div>
          <div class="program-card-actions">
            <a href="${escapeHtml(learnMoreUrl)}" class="program-card-learn-more">LEARN MORE</a>
            <a href="${escapeHtml(registerUrl)}" class="program-card-register">REGISTER</a>
          </div>
        </div>
      `;
    }

    /**
     * Load upcoming programs from Airtable and populate on faculty cards
     */
    async function loadFacultyPrograms() {
      try {
        // Fetch all program instances (no filter - we'll filter in JS)
        const records = await fetchAllAirtableRecords(
          AIRTABLE_CONFIG.programInstancesTableId
        );
        // Filter in JavaScript: Show on Website = true, Start Date >= today, AND is allowed program
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        const filteredRecords = records.filter(record => {
          const showOnWebsite = record.fields['Show on Website'];
          const startDate = record.fields['Start Date'];
          // Program Name might be an array (linked record) or string - handle both
          let programNameRaw = record.fields['Program Name'];
          if (Array.isArray(programNameRaw)) {
            programNameRaw = programNameRaw[0] || '';
          }
          const programName = (programNameRaw || '').toLowerCase();

          // Must be marked to show on website
          if (!showOnWebsite) return false;

          // Must have a future start date
          if (!startDate) return false;
          const programDate = new Date(startDate);
          if (programDate < today) return false;

          // Must be a certificate program OR Employment Law Update
          const isAllowed = programName.includes('certificate') || programName.includes('employment law update');
          return isAllowed;
        });

        populateFacultyPrograms(filteredRecords);
      } catch (error) {
        console.error('Error loading faculty programs:', error);
        // Silently fail - programs section just won't show
      }
    }

    /**
     * Populate programs on faculty cards based on Block Instructor fields
     */
    function populateFacultyPrograms(programRecords) {
      // Group programs by faculty ID
      const programsByFaculty = {};

      programRecords.forEach(record => {
        // Program Name might be an array (linked record) or string - handle both
        let programNameRaw = record.fields['Program Name'];
        if (Array.isArray(programNameRaw)) {
          programNameRaw = programNameRaw[0];
        }
        const program = {
          name: programNameRaw || record.fields['Instance Name'] || 'Program',
          startDate: record.fields['Start Date'],
          endDate: record.fields['End Date'],
          format: record.fields['Format'] || '',
          city: record.fields['City'] || '',
          state: record.fields['State/Province'] || '',
          registrationUrl: record.fields['Registration URL'] || ''
        };

        // Check Block 1, 2, 3 Instructors - these are linked record fields containing record IDs
        const instructorFields = [
          'Block 1 Instructor',
          'Block 2 Instructor',
          'Block 3 Instructor'
        ];

        instructorFields.forEach(field => {
          const instructorRecordIds = record.fields[field];
          if (!instructorRecordIds) return;

          // Handle both array and single value (linked records are arrays)
          const recordIds = Array.isArray(instructorRecordIds) ? instructorRecordIds : [instructorRecordIds];

          recordIds.forEach(recordId => {
            if (!recordId) return;
            // Match record ID against instructorRecordMap (recordId → facultyId)
            const facultyId = instructorRecordMap[recordId];
            if (facultyId) {
              if (!programsByFaculty[facultyId]) {
                programsByFaculty[facultyId] = [];
              }
              // Avoid duplicates (same program, same faculty)
              const isDuplicate = programsByFaculty[facultyId].some(
                p => p.name === program.name && p.startDate === program.startDate
              );
              if (!isDuplicate) {
                programsByFaculty[facultyId].push(program);
              }
            }
          });
        });
      });

      // Populate programs on each faculty card
      Object.entries(programsByFaculty).forEach(([facultyId, programs]) => {
        const programsContainer = document.getElementById(`programs-${facultyId}`);
        if (!programsContainer) return;

        // Sort by start date
        programs.sort((a, b) => new Date(a.startDate) - new Date(b.startDate));

        // Generate HTML
        const programsHtml = programs.map(p => createProgramCardHtml(p)).join('');

        programsContainer.innerHTML = `
          <div class="teaching-programs-header">
            <span class="teaching-programs-title">Upcoming Programs</span>
            <span class="teaching-programs-count">${programs.length}</span>
          </div>
          <div class="programs-cards">
            ${programsHtml}
          </div>
        `;

        // Show the teaching-programs container
        const teachingProgramsDiv = programsContainer.closest('.teaching-programs');
        if (teachingProgramsDiv) {
          teachingProgramsDiv.style.display = 'block';
        }
      });
    }

    // ============================================================================
    // TESTIMONIALS
    // ============================================================================

    // Store instructor record IDs mapped to faculty IDs for testimonial matching
    let instructorRecordMap = {};

    /**
     * Load testimonials from Airtable and populate them on faculty cards
     */
    async function loadTestimonials() {
      try {
        const records = await fetchAllAirtableRecords(AIRTABLE_CONFIG.testimonialsTableId);
        populateTestimonials(records);
      } catch (error) {
        console.error('Error loading testimonials:', error);
      }
    }

    /**
     * Populate testimonials on faculty cards
     */
    function populateTestimonials(testimonialRecords) {
      // Group testimonials by instructor record ID
      const testimonialsByInstructor = {};

      testimonialRecords.forEach(record => {
        const instructorIds = record.fields['FACULTY'] || [];
        const quoteText = record.fields['Testimonial Text'] || '';
        const participantName = record.fields['Author Name'] || '';
        const participantTitle = record.fields['Author Title'] || '';
        // Use lookup field for company name (linked record returns ID, lookup returns text)
        let participantCompany = record.fields['Company Name'] || '';
        if (Array.isArray(participantCompany)) {
          participantCompany = participantCompany[0] || '';
        }

        // Skip if no quote text
        if (!quoteText.trim()) return;

        // Add testimonial to each linked instructor
        instructorIds.forEach(instructorId => {
          if (!testimonialsByInstructor[instructorId]) {
            testimonialsByInstructor[instructorId] = [];
          }
          testimonialsByInstructor[instructorId].push({
            quote: quoteText,
            name: participantName,
            title: participantTitle,
            company: participantCompany
          });
        });
      });

      // Populate testimonials on each faculty card (one random testimonial per instructor)
      Object.entries(instructorRecordMap).forEach(([recordId, facultyId]) => {
        const testimonials = testimonialsByInstructor[recordId];
        if (!testimonials || testimonials.length === 0) return;

        const testimonialSection = document.getElementById(`testimonials-${facultyId}`);
        if (!testimonialSection) return;

        // Pick one random testimonial
        const randomIndex = Math.floor(Math.random() * testimonials.length);
        const t = testimonials[randomIndex];

        // Build single testimonial card HTML
        const testimonialCardHtml = `
          <div class="testimonial-card">
            <div class="testimonial-stars"><img src="https://storage.googleapis.com/msgsndr/MjGEy0pobNT9su2YJqFI/media/68d667936fe1a53fe6603670.png" alt="5 stars" class="stars-img"></div>
            <p class="testimonial-text">"${escapeHtml(t.quote)}"</p>
            <div class="testimonial-attribution">
              <div class="testimonial-author">${escapeHtml(t.name)}</div>
              ${t.title ? `<div class="testimonial-role">${escapeHtml(t.title)}</div>` : ''}
              ${t.company ? `<div class="testimonial-company">${escapeHtml(t.company)}</div>` : ''}
            </div>
          </div>
        `;

        testimonialSection.innerHTML = testimonialCardHtml;
        testimonialSection.style.display = 'block';
      });
    }

    /**
     * Modified instructor loading to store record ID mapping
     */
    async function loadInstructorDataWithMapping() {
      try {
        const records = await fetchAllAirtableRecords(AIRTABLE_CONFIG.facultyTableId);

        // Build mapping of Airtable record IDs to faculty IDs
        records.forEach(record => {
          let instructorName = record.fields['Full Name'] || '';

          // Handle case where name is in title field
          if (!instructorName && record.fields['Current Title']) {
            let titleField = record.fields['Current Title'];
            let separators = [' – ', ' - ', ' — ', ' | ', '  '];
            for (let separator of separators) {
              if (titleField.includes(separator)) {
                instructorName = titleField.split(separator)[0].trim();
                break;
              }
            }
            if (!instructorName) instructorName = titleField;
          }

          const facultyId = instructorName.toLowerCase()
            .replace(/[^a-z0-9\s]/g, '')
            .replace(/\s+/g, '-')
            .replace(/^-+|-+$/g, '');

          instructorRecordMap[record.id] = facultyId;

          // Build name-to-ID mapping for program matching
          // Use "Full Name with Credentials" field which matches the lookup in Program Instances
          const fullNameWithCredentials = record.fields['Full Name with Credentials'];
          if (fullNameWithCredentials) {
            facultyNameToIdMap[fullNameWithCredentials.trim()] = facultyId;
          }
          // Also map by "Full Name" as fallback
          if (instructorName) {
            facultyNameToIdMap[instructorName.trim()] = facultyId;
          }
        });

        populateFacultyCards(records);
        handleDeepLink();

        // Load programs and testimonials after faculty cards are populated
        await Promise.all([
          loadFacultyPrograms(),
          loadTestimonials()
        ]);

      } catch (error) {
        console.error('Error loading instructor data:', error);
        document.querySelectorAll('.faculty-grid').forEach(grid => {
          grid.innerHTML = '<p class="loading-skeleton">Unable to load faculty data. Please refresh the page.</p>';
        });
      }
    }

    // ============================================================================
    // INITIALIZATION
    // ============================================================================

    document.addEventListener('DOMContentLoaded', () => {
      loadInstructorDataWithMapping();
    });

    // Handle hash changes for deep linking
    window.addEventListener('hashchange', handleDeepLink);
  </script>

</body>
</html>
